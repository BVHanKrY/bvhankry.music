<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BVHanKrY - M√∫sica Oficial</title>
    <!-- Fuente Roboto -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="icon" href="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/refs/heads/main/iconos/pesta%C3%B1a%20simbo.png" type="image/png">
    <style>
        :root {
            --primary: #000000;
            --primary-dark: #000000;
            --bg-light: #ffffff;
            --bg-card: #ffffff;
            --text-main: #000000;
            --text-muted: #333333;
            --accent-gray: #f4f4f4;
            
            /* Textura de rayas diagonales */
            --pattern-stripe: repeating-linear-gradient(
                45deg,
                #000000,
                #000000 2px,
                transparent 2px,
                transparent 6px
            );
        }
        * { margin: 0; padding: 0; box-sizing: border-box; 
           font-family: 'Roboto', sans-serif;
           scroll-behavior: smooth; }
        
        body { 
            background-color: #ffffff; 
            color: var(--text-main); 
            min-height: 100vh; 
            padding-bottom: 60px; 
            overflow-x: hidden;
        }

        /* Navegaci√≥n */
        .main-nav { 
            background-color: rgba(255,255,255, 0.98); 
            backdrop-filter: blur(5px);
            padding: 15px 0; 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            z-index: 1000; 
            border-bottom: 3px solid #000000; 
            transition: transform 0.3s ease-in-out; 
            width: 100%; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .main-nav.hidden-nav { transform: translateY(-100%); }
        .nav-container { display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 0 5%; max-width: 1400px; margin: 0 auto; }
        .logo img { height: 40px; filter: grayscale(100%) brightness(0); transition: transform 0.2s; }
        .logo:hover img { transform: scale(1.05); }
        .nav-links { display: flex; list-style: none; gap: 30px; }
        .nav-links a { color: #000000; text-decoration: none; font-weight: 700; font-size: 0.9rem; letter-spacing: 1px; text-transform: uppercase; position: relative; }
        .nav-links a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 0; background-color: #000; transition: width 0.3s; }
        .nav-links a:hover::after { width: 100%; }
        
        .social-links { display: flex; gap: 15px; }
        .social-links a img { height: 22px; transition: transform 0.2s, filter 0.2s; filter: grayscale(100%) brightness(0); }
        .social-links a:hover img { transform: translateY(-3px); filter: grayscale(0%) brightness(0); }
        
        /* Contenedor Principal */
        .container { max-width: 1200px; margin: 120px auto 60px; padding: 0 20px; }
        
        /* Header */
        header { text-align: center; padding: 40px 0 40px; margin-bottom: 40px; }
        header h1 { 
            color: #000000; 
            font-size: clamp(3rem, 8vw, 6rem); 
            font-weight: 900; 
            margin-bottom: 15px; 
            letter-spacing: -3px; 
            line-height: 1;
            text-transform: uppercase;
        }
        header p { 
            font-size: 1.2rem; 
            color: #000000; 
            text-transform: uppercase; 
            letter-spacing: 8px; 
            font-weight: 700;
            border-bottom: 3px solid #000000;
            display: inline-block;
            padding-bottom: 10px;
        }
        
        .ep-title { text-align: center; color: #000000; font-size: 2rem; font-weight: 900; margin-bottom: 80px; letter-spacing: 5px; text-transform: uppercase; position: relative; display: inline-block; left: 50%; transform: translateX(-50%); }
        .ep-title::after { content: ''; width: 100%; height: 6px; background: var(--pattern-stripe); position: absolute; bottom: -10px; left: 0; z-index: -1; }
        
        /* Grid de Canciones */
        .songs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 50px; margin-bottom: 100px; }
        
        .cancion-card { 
            background: var(--bg-card); 
            border-radius: 4px; 
            padding: 0; 
            border: 2px solid #000000; 
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.3s; 
            display: flex; 
            flex-direction: column; 
            box-shadow: 10px 10px 0px #000000;
            position: relative;
            overflow: hidden;
        }
        .cancion-card:hover { transform: translate(-6px, -6px); box-shadow: 14px 14px 0px #000000; }
        
        .cancion-card h3 { 
            font-size: 1.4rem; 
            font-weight: 900; 
            color: #ffffff; 
            background-color: #000000;
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            padding: 20px; 
            border-bottom: 2px solid #000000; 
            text-transform: uppercase;
        }
        
        .total-reviews-badge { font-size: 0.7rem; background: #ffffff; color: #000000; padding: 4px 10px; border-radius: 50px; font-weight: 900; letter-spacing: 1px; border: 2px solid #ffffff; }
        
        .song-stats { display: flex; justify-content: space-between; padding: 15px 20px; background: #fafafa; border-bottom: 1px solid #000000; font-size: 0.8rem; color: #000000; letter-spacing: 1px; font-weight: 700; }
        
        .likes-counter { cursor: pointer; display: flex; align-items: center; gap: 8px; transition: color 0.3s; user-select: none; }
        .likes-counter:hover .heart-icon { color: #cc0000; transform: scale(1.2); }
        .heart-icon { font-size: 1.2em; transition: transform 0.2s, color 0.2s; color: #000000; display: inline-block; }
        .heart-icon.liked { color: #cc0000; animation: pulse 0.4s; }
        
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.4); } 100% { transform: scale(1.2); } }

        .player-wrapper { background: #ffffff; padding: 25px 20px; display: flex; flex-direction: column; gap: 15px; }
        .audio-controls { display: flex; align-items: center; gap: 15px; }
        
        .play-btn { 
            width: 45px; 
            height: 45px; 
            background: #000000; 
            border: 2px solid #000000; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            transition: transform 0.1s, background 0.2s; 
            flex-shrink: 0; 
            border-radius: 50%;
        }
        .play-btn:hover { background: #333; transform: scale(1.05); }
        .play-btn:active { transform: scale(0.95); }
        
        .icon-play, .icon-pause { width: 14px; height: 14px; fill: white; pointer-events: none; }
        
        .progress-container { 
            flex-grow: 1; 
            height: 6px; 
            background-color: #e0e0e0; 
            border-radius: 3px; 
            position: relative; 
            cursor: pointer; 
            overflow: hidden; 
        }
        .progress-bar { 
            height: 100%; 
            background-color: #000000; 
            border-radius: 3px; 
            width: 0%; 
            transition: width 0.1s linear; 
        }
        
        .time-display { font-size: 0.75rem; color: #666; font-variant-numeric: tabular-nums; min-width: 85px; text-align: right; font-weight: 500; }
        
        .volume-wrapper { display: flex; align-items: center; justify-content: center; width: 30px; }
        .volume-btn { background: none; border: none; cursor: pointer; color: #000; display: flex; align-items: center; justify-content: center; transition: opacity 0.2s; }
        .volume-btn:hover { opacity: 0.7; }
        .volume-btn svg { width: 20px; height: 20px; fill: currentColor; }
        .volume-btn.muted { opacity: 0.4; }
        
        .song-copyright { padding: 15px 20px; font-size: 0.7em; color: #777; text-align: center; letter-spacing: 1px; border-top: 1px dashed #ccc; background: #fdfdfd; margin-top: auto; }
        .share-button-container { padding: 20px; text-align: center; border-top: 2px solid #000; background: #fff; }
        .share-whatsapp { display: inline-flex; align-items: center; justify-content: center; gap: 10px; width: 100%; padding: 12px 0; background-color: #000000; color: white; text-decoration: none; font-size: 0.9em; font-weight: 700; letter-spacing: 1px; transition: background 0.2s; text-transform: uppercase; }
        .share-whatsapp:hover { background-color: #25D366; } /* Color oficial WhatsApp */
        
        /* Secciones Informativas */
        .info-sections { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px; margin-top: 50px; }
        section { padding: 40px; background: var(--bg-card); border-radius: 0px; border: 3px solid #000000; box-shadow: 8px 8px 0px rgba(0,0,0,1); transition: transform 0.3s; }
        section:hover { transform: translate(-2px, -2px); box-shadow: 10px 10px 0px rgba(0,0,0,1); }
        section h2 { color: #000000; margin-bottom: 20px; font-weight: 900; letter-spacing: 2px; font-size: 1.8rem; text-transform: uppercase; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        section p { color: #444; font-size: 1rem; line-height: 1.7; font-weight: 400; }
        
        footer { text-align: center; margin-top: 100px; padding: 40px; border-top: 4px solid #000000; font-size: 0.9em; color: #000000; letter-spacing: 2px; font-weight: 700; background: #fff; }

        /* Notificaci√≥n Toast */
        #toast-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 2000; pointer-events: none; }
        .toast { background-color: #000; color: #fff; padding: 12px 24px; border-radius: 4px; margin-top: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); opacity: 0; transform: translateY(20px); transition: opacity 0.3s, transform 0.3s; font-size: 0.85rem; display: flex; align-items: center; gap: 10px; }
        .toast.show { opacity: 1; transform: translateY(0); }
        .toast.success { border-left: 4px solid #fff; }
        .toast.info { border-left: 4px solid #555; }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-container { flex-direction: column; gap: 15px; padding: 15px; }
            .nav-links { gap: 20px; width: 100%; justify-content: center; }
            header h1 { font-size: 3.5rem; }
            header p { font-size: 0.9rem; letter-spacing: 4px; }
            .cancion-card { box-shadow: 6px 6px 0px #000000; }
            .cancion-card:hover { transform: none; box-shadow: 6px 6px 0px #000000; }
        }
    </style>
</head>
<body>
    <!-- Navegaci√≥n -->
    <nav class="main-nav">
        <div class="nav-container">
            <a href="#" class="logo"><img src="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/refs/heads/main/iconos/pesta%C3%B1a%20simbo.png" alt="Logo BVHanKrY"></a>
            <ul class="nav-links">
                <li><a href="#music">M√∫sica</a></li>
                <li><a href="#videos">Videos</a></li>
                <li><a href="#shop">Shop</a></li>
            </ul>
            <ul class="social-links">
                <li><a href="https://www.instagram.com/henryandresvill/" target="_blank" aria-label="Instagram"><img src="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/refs/heads/main/multimedia/instagram.png" alt="Instagram"></a></li>
                <li><a href="https://wa.link/uuajw5" target="_blank" aria-label="WhatsApp"><img src="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/refs/heads/main/multimedia/whatsapp.png" alt="WhatsApp"></a></li>
                <li><a href="https://www.youtube.com/channel/UCJrxTphZnI8Rm_GTyCJp44g" target="_blank" aria-label="YouTube"><img src="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/refs/heads/main/multimedia/youtube.png" alt="YouTube"></a></li>
                <li><a href="https://open.spotify.com/intl-es/artist/0IPDl4adPnkF6LaoEyUwDl" target="_blank" aria-label="Spotify"><img src="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/refs/heads/main/multimedia/spotify.png" alt="Spotify"></a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <header>
            <h1>BVHanKrY</h1>
            <p>DUB Music - Ecuador</p>
        </header>

        <h2 class="ep-title">EP: Pulso</h2>

        <div class="songs-grid" id="music">
            <!-- 1. NAVI -->
            <article class="cancion-card" data-song="navi" data-review-id="total-reviews">
                <h3><span class="icon">üéµ</span> Navi <span class="total-reviews-badge">Reviews: <span class="count-display">0</span></span></h3>
                <div class="song-stats">
                    <div class="likes-counter" title="Dar Me gusta"><span class="heart-icon">‚ù§</span> <span class="likes-count">0</span> Likes</div>
                    <div class="plays-counter">‚ñ∂ <span class="plays-count">0</span> Plays</div>
                </div>
                <div class="player-wrapper">
                    <div class="audio-controls">
                        <button class="play-btn" aria-label="Reproducir">
                            <svg class="icon-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                            <svg class="icon-pause" viewBox="0 0 24 24" style="display:none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                        </button>
                        <div class="progress-container"><div class="progress-bar"></div></div>
                        <div class="time-display">0:00</div>
                        <div class="volume-wrapper">
                            <button class="volume-btn" aria-label="Silenciar">
                                <!-- SVG Volumen Alto -->
                                <svg class="vol-high" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                                <!-- SVG Mute (Oculto inicialmente) -->
                                <svg class="vol-mute" viewBox="0 0 24 24" style="display:none;"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73 4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>
                            </button>
                        </div>
                    </div>
                </div>
                <audio src="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/main/audio/navi.mp3" preload="metadata"></audio>
                <div class="song-copyright"><p>Compositor: BVHanKrY | Producci√≥n: BVros</p><p>‚Ñó 2026 BVHanKrY</p></div>
                <div class="share-button-container"><a href="https://wa.me/?text=¬°Escucha%20Navi!%20https://bvhankry.onrender.com" target="_blank" class="share-whatsapp">Compartir en WhatsApp</a></div>
            </article>

            <!-- 2. SUBTLE GAD -->
            <article class="cancion-card" data-song="subtle_gad" data-review-id="total-reviews-2">
                <h3><span class="icon">üéµ</span> Subtle Gad <span class="total-reviews-badge">Reviews: <span class="count-display">0</span></span></h3>
                <div class="song-stats">
                    <div class="likes-counter" title="Dar Me gusta"><span class="heart-icon">‚ù§</span> <span class="likes-count">0</span> Likes</div>
                    <div class="plays-counter">‚ñ∂ <span class="plays-count">0</span> Plays</div>
                </div>
                <div class="player-wrapper">
                    <div class="audio-controls">
                        <button class="play-btn" aria-label="Reproducir">
                            <svg class="icon-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                            <svg class="icon-pause" viewBox="0 0 24 24" style="display:none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                        </button>
                        <div class="progress-container"><div class="progress-bar"></div></div>
                        <div class="time-display">0:00</div>
                        <div class="volume-wrapper">
                            <button class="volume-btn" aria-label="Silenciar">
                                <svg class="vol-high" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                                <svg class="vol-mute" viewBox="0 0 24 24" style="display:none;"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73 4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>
                            </button>
                        </div>
                    </div>
                </div>
                <audio src="https://raw.githubusercontent.com/BVHanKrY/bvhankry.music/main/audio/Subtle gad.mp3" preload="metadata"></audio>
                <div class="song-copyright"><p>Compositor: BVHanKrY | Producci√≥n: BVros</p><p>‚Ñó 2026 BVHanKrY</p></div>
                <div class="share-button-container"><a href="https://wa.me/?text=¬°Escucha%20Subtle%20Gad!%20https://bvhankry.onrender.com" target="_blank" class="share-whatsapp">Compartir en WhatsApp</a></div>
            </article>

            <!-- 3. REGRESI√ìN -->
            <article class="cancion-card" data-song="regrecion" data-review-id="total-reviews-3">
                <h3><span class="icon">üéµ</span> Regresi√≥n <span class="total-reviews-badge">Reviews: <span class="count-display">0</span></span></h3>
                <div class="song-stats">
                    <div class="likes-counter" title="Dar Me gusta"><span class="heart-icon">‚ù§</span> <span class="likes-count">0</span> Likes</div>
                    <div class="plays-counter">‚ñ∂ <span class="plays-count">0</span> Plays</div>
                </div>
                <div class="player-wrapper">
                    <div class="audio-controls">
                        <button class="play-btn" aria-label="Reproducir">
                            <svg class="icon-play" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                            <svg class="icon-pause" viewBox="0 0 24 24" style="display:none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                        </button>
                        <div class="progress-container"><div class="progress-bar"></div></div>
                        <div class="time-display">0:00</div>
                        <div class="volume-wrapper">
                            <button class="volume-btn" aria-label="Silenciar">
                                <svg class="vol-high" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                                <svg class="vol-mute" viewBox="0 0 24 24" style="display:none;"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73 4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>
                            </button>
                        </div>
                    </div>
                </div>
                <audio src="https://github.com/BVHanKrY/bvhankry.music/raw/refs/heads/main/audio/regrecion.mp3" preload="metadata"></audio>
                <div class="song-copyright"><p>Compositor: BVHanKrY | Producci√≥n: BVros</p><p>‚Ñó 2026 BVHanKrY</p></div>
                <div class="share-button-container"><a href="https://wa.me/?text=¬°Escucha%20Regresi√≥n!%20https://bvhankry.onrender.com" target="_blank" class="share-whatsapp">Compartir en WhatsApp</a></div>
            </article>
        </div>

        <div class="info-sections">
            <section><h2>M√∫sica</h2><p>EP completo "Pulso" disponible ahora en todas las plataformas digitales. Sum√©rgete en el sonido Dub de Ecuador.</p></section>
            <section id="videos"><h2>Videos</h2><p>Videoclips oficiales y contenido visual detr√°s de c√°maras. Pr√≥ximamente.</p></section>
            <section id="shop"><h2>Shop</h2><p>Merch oficial exclusiva. Camisetas, vinilos y accesorios.</p></section>
        </div>
        
        <footer><p>¬© 2026 BVHanKrY | Todos los derechos reservados</p></footer>
    </div>

    <!-- Contenedor para notificaciones -->
    <div id="toast-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const formatTime = (seconds) => { 
                if (isNaN(seconds)) return "0:00"; 
                const mins = Math.floor(seconds / 60); 
                const secs = Math.floor(seconds % 60); 
                return `${mins}:${secs < 10 ? '0' + secs : secs}`; 
            };
            
            let currentAudio = null;
            let currentBtn = null;
            
            // Funci√≥n para mostrar notificaciones Toast (reemplazo de alert)
            function showToast(message, type = 'success') {
                const container = document.getElementById('toast-container');
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                container.appendChild(toast);
                
                // Forzar reflow para animaci√≥n
                setTimeout(() => toast.classList.add('show'), 10);
                
                // Eliminar despu√©s de 3 segundos
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            }

            document.querySelectorAll('.cancion-card').forEach(card => {
                const songName = card.dataset.song;
                const audio = card.querySelector('audio');
                const playBtn = card.querySelector('.play-btn');
                const playIcon = playBtn.querySelector('.icon-play');
                const pauseIcon = playBtn.querySelector('.icon-pause');
                const progressBar = card.querySelector('.progress-bar');
                const progressContainer = card.querySelector('.progress-container');
                const timeDisplay = card.querySelector('.time-display');
                const volumeBtn = card.querySelector('.volume-btn');
                const volHigh = volumeBtn.querySelector('.vol-high');
                const volMute = volumeBtn.querySelector('.vol-mute');
                
                const likesCount = card.querySelector('.likes-count');
                const playsCount = card.querySelector('.plays-count');
                const reviewBadgeCount = card.querySelector('.count-display'); // Elemento espec√≠fico en el t√≠tulo
                
                const heartIcon = card.querySelector('.heart-icon');
                const likeBtn = card.querySelector('.likes-counter');

                // Cargar datos guardados
                const storedLikes = localStorage.getItem(`cant-gustos-${songName}`);
                const storedPlays = localStorage.getItem(`reviews-${songName}`);
                
                if (storedLikes) likesCount.textContent = storedLikes;
                if (storedPlays) {
                    playsCount.textContent = storedPlays;
                    if(reviewBadgeCount) reviewBadgeCount.textContent = storedPlays; // Sincronizar badge
                }
                
                if (localStorage.getItem(`gusto-${songName}`) === 'activado') heartIcon.classList.add('liked');

                // --- Control de Play/Pause ---
                playBtn.addEventListener('click', () => {
                    // Si hay otra canci√≥n sonando, detenerla
                    if (currentAudio && currentAudio !== audio && !currentAudio.paused) {
                        currentAudio.pause();
                        currentAudio.currentTime = 0; // Opcional: resetear canci√≥n anterior
                        
                        // Resetear bot√≥n anterior visualmente
                        if (currentBtn) {
                            const prevPlay = currentBtn.querySelector('.icon-play');
                            const prevPause = currentBtn.querySelector('.icon-pause');
                            prevPlay.style.display = 'block';
                            prevPause.style.display = 'none';
                        }
                    }

                    if (audio.paused) {
                        const playPromise = audio.play();
                        if (playPromise !== undefined) {
                            playPromise.then(_ => {
                                currentAudio = audio;
                                currentBtn = playBtn;
                                playIcon.style.display = 'none';
                                pauseIcon.style.display = 'block';
                                
                                // Contar reproducci√≥n si no se ha contado en esta sesi√≥n
                                if (!audio.dataset.counted) {
                                    let plays = parseInt(playsCount.textContent) + 1;
                                    playsCount.textContent = plays;
                                    if(reviewBadgeCount) reviewBadgeCount.textContent = plays; // Actualizar badge
                                    
                                    localStorage.setItem(`reviews-${songName}`, plays);
                                    audio.dataset.counted = 'true';
                                    // showToast(`Reproduciendo: ${songName.replace('_', ' ')}`, 'info');
                                }
                            }).catch(error => console.error("Error reproduciendo:", error));
                        }
                    } else {
                        audio.pause();
                        playIcon.style.display = 'block';
                        pauseIcon.style.display = 'none';
                    }
                });

                // --- Barra de Progreso ---
                audio.addEventListener('timeupdate', () => { 
                    if (audio.duration) { 
                        const percent = (audio.currentTime / audio.duration) * 100; 
                        progressBar.style.width = percent + "%"; 
                        timeDisplay.textContent = formatTime(audio.currentTime) + " / " + formatTime(audio.duration); 
                    } 
                });

                progressContainer.addEventListener('click', (e) => { 
                    if (audio.duration) { 
                        const width = progressContainer.clientWidth; 
                        const clickX = e.offsetX; 
                        audio.currentTime = (clickX / width) * audio.duration; 
                    } 
                });

                audio.addEventListener('ended', () => { 
                    playIcon.style.display = 'block'; 
                    pauseIcon.style.display = 'none'; 
                    progressBar.style.width = "0%"; 
                    timeDisplay.textContent = "0:00 / " + formatTime(audio.duration);
                    audio.dataset.counted = 'false'; // Permitir contar nueva reproducci√≥n si se reproduce de nuevo
                });

                audio.addEventListener('loadedmetadata', () => { 
                    timeDisplay.textContent = "0:00 / " + formatTime(audio.duration); 
                });

                // --- Control de Volumen ---
                volumeBtn.addEventListener('click', () => { 
                    audio.muted = !audio.muted; 
                    if (audio.muted) { 
                        volHigh.style.display = 'none';
                        volMute.style.display = 'block';
                        volumeBtn.classList.add('muted'); 
                    } else { 
                        volHigh.style.display = 'block';
                        volMute.style.display = 'none';
                        volumeBtn.classList.remove('muted'); 
                    } 
                });

                // --- Bot√≥n Me Gusta ---
                likeBtn.addEventListener('click', () => { 
                    if (localStorage.getItem(`gusto-${songName}`) === 'activado') { 
                        showToast("Ya le diste Me Gusta a esta canci√≥n", 'info'); 
                        return; 
                    } 
                    
                    const likes = parseInt(likesCount.textContent) + 1; 
                    likesCount.textContent = likes; 
                    localStorage.setItem(`cant-gustos-${songName}`, likes); 
                    localStorage.setItem(`gusto-${songName}`, 'activado'); 
                    heartIcon.classList.add('liked'); 
                    showToast("¬°Gracias por tu Me Gusta!", 'success');
                });
            });
        });

        // Navbar hide/show logic (Mantiene la funcionalidad original pero mejorada)
        let lastScrollTop = 0;
        const delta = 5;
        const navbar = document.querySelector('.main-nav');
        const navbarHeight = navbar.offsetHeight;

        window.addEventListener('scroll', function() {
            let st = window.pageYOffset || document.documentElement.scrollTop;
            
            if (Math.abs(lastScrollTop - st) <= delta) return;

            if (st > lastScrollTop && st > navbarHeight) {
                // Scroll Down -> Ocultar
                navbar.classList.add('hidden-nav');
            } else {
                // Scroll Up -> Mostrar
                navbar.classList.remove('hidden-nav');
            }
            lastScrollTop = st;
        });
    </script>
</body>
</html>
